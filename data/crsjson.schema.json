{
  "$id": "https://proj.org/crsjson.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Schema for CRS JSON",

  "oneOf": [
    { "$ref": "#/definitions/crs" },
    { "$ref": "#/definitions/datum" },
    { "$ref": "#/definitions/ellipsoid" },
    { "$ref": "#/definitions/prime_meridian" },
    { "$ref": "#/definitions/single_operation" },
    { "$ref": "#/definitions/concatenated_operation" }
  ],

  "definitions": {

    "abridged_transformation": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["AbridgedTransformation"] },
        "name": { "type": "string" },
        "method": { "$ref": "#/definitions/method" },
        "parameters": {
            "type": "array",
            "items": { "$ref": "#/definitions/parameter_value" }
        },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name", "method", "parameters" ],
      "additionalProperties": false
    },

    "axis": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["Axis"] },
        "name": { "type": "string" },
        "abbreviation": { "type": "string" },
        "direction": { "type": "string" },
        "unit": { "$ref": "#/definitions/unit" },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name" ],
      "additionalProperties": false
    },

    "bbox": {
      "type": "object",
      "properties": {
        "east_longitude": { "type": "number" },
        "west_longitude": { "type": "number" },
        "south_latitude": { "type": "number" },
        "north_latitude": { "type": "number" }
      },
      "required" : [ "east_longitude", "west_longitude",
                     "south_latitude", "north_latitude" ],
      "additionalProperties": false
    },

    "bound_crs": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["BoundCRS"] },
        "source_crs": { "$ref": "#/definitions/crs" },
        "target_crs": { "$ref": "#/definitions/crs" },
        "transformation": { "$ref": "#/definitions/abridged_transformation" }
     },
     "required" : [ "source_crs", "target_crs", "transformation" ],
     "additionalProperties": false
    },

    "compound_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["CompoundCRS"] },
        "name": { "type": "string" },
        "components":  {
           "type": "array",
            "items": { "$ref": "#/definitions/crs" }
        },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "components" ],
      "additionalProperties": false
    },

    "concatenated_operation": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["ConcatenatedOperation"] },
        "name": { "type": "string" },
        "source_crs": { "$ref": "#/definitions/crs" },
        "target_crs": { "$ref": "#/definitions/crs" },
        "steps":  {
           "type": "array",
            "items": { "$ref": "#/definitions/single_operation" }
        },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "source_crs", "target_crs", "steps" ],
      "additionalProperties": false
    },

    "conversion": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["Conversion"] },
        "name": { "type": "string" },
        "method": { "$ref": "#/definitions/method" },
        "parameters": {
            "type": "array",
            "items": { "$ref": "#/definitions/parameter_value" }
        },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name", "method" ],
      "additionalProperties": false
    },

    "coordinate_system": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["CoordinateSystem"] },
        "name": { "type": "string" },
        "subtype": { "type": "string" },
        "axis": {
            "type": "array",
            "items": { "$ref": "#/definitions/axis" }
        },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "subtype", "axis" ],
      "additionalProperties": false
    },

    "crs": {
      "oneOf": [
        { "$ref": "#/definitions/geodetic_crs" },
        { "$ref": "#/definitions/derived_crs" },
        { "$ref": "#/definitions/vertical_crs" },
        { "$ref": "#/definitions/compound_crs" },
        { "$ref": "#/definitions/bound_crs" },
        { "$ref": "#/definitions/engineering_crs" },
        { "$ref": "#/definitions/parametric_crs" },
        { "$ref": "#/definitions/temporal_crs" }
      ]
    },

    "datum": {
      "oneOf": [
        { "$ref": "#/definitions/geodetic_reference_frame" },
        { "$ref": "#/definitions/vertical_reference_frame" },
        { "$ref": "#/definitions/temporal_datum" },
        { "$ref": "#/definitions/parametric_datum" },
        { "$ref": "#/definitions/engineering_datum" }
      ]
    },

    "derived_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string",
                  "enum": ["ProjectedCRS",
                           "DerivedGeodeticCRS",
                           "DerivedGeographicCRS",
                           "DerivedProjectedCRS",
                           "DerivedVerticalCRS",
                           "DerivedTemporalCRS",
                           "DerivedParametricCRS",
                           "DerivedEngineeringCRS"] },
        "name": { "type": "string" },
        "base_crs": { "$ref": "#/definitions/crs" },
        "conversion": { "$ref": "#/definitions/conversion" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
     },
     "required" : [ "name", "base_crs", "conversion", "coordinate_system" ],
     "additionalProperties": false
    },

    "ellipsoid": {
      "type": "object",
      "oneOf":[
        {
          "properties": {
            "type": { "type": "string", "enum": ["Ellipsoid"] },
            "name": { "type": "string" },
            "semi_major_axis": { "$ref": "#/definitions/value_in_metre_or_value_and_unit" },
            "semi_minor_axis": { "$ref": "#/definitions/value_in_metre_or_value_and_unit" },
            "id": { "$ref": "#/definitions/id" }
          },
          "required" : [ "name", "semi_major_axis", "semi_minor_axis" ],
          "additionalProperties": false
        },
        {
          "properties": {
            "type": { "type": "string", "enum": ["Ellipsoid"] },
            "name": { "type": "string" },
            "semi_major_axis": { "$ref": "#/definitions/value_in_metre_or_value_and_unit" },
            "inverse_flattening": { "type": "number" },
            "id": { "$ref": "#/definitions/id" }
          },
          "required" : [ "name", "semi_major_axis", "inverse_flattening" ],
          "additionalProperties": false
        },
        {
          "properties": {
            "type": { "type": "string", "enum": ["Ellipsoid"] },
            "name": { "type": "string" },
            "radius": { "$ref": "#/definitions/value_in_metre_or_value_and_unit" },
            "id": { "$ref": "#/definitions/id" }
          },
          "required" : [ "name", "radius" ],
         "additionalProperties": false
        }
      ]
    },

    "engineering_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["EngineeringCRS"] },
        "name": { "type": "string" },
        "datum": { "$ref": "#/definitions/engineering_datum" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "datum" ],
      "additionalProperties": false
    },

    "engineering_datum": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["EngineeringDatum"] },
        "name": { "type": "string" },
        "anchor": { "type": "string" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name" ],
      "additionalProperties": false
    },

    "geodetic_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["GeodeticCRS", "GeographicCRS"] },
        "name": { "type": "string" },
        "datum": { "$ref": "#/definitions/geodetic_reference_frame" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "datum" ],
      "additionalProperties": false
    },

    "geodetic_reference_frame": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["GeodeticReferenceFrame"] },
        "name": { "type": "string" },
        "anchor": { "type": "string" },
        "ellipsoid": { "$ref": "#/definitions/ellipsoid" },
        "prime_meridian": { "$ref": "#/definitions/prime_meridian" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "ellipsoid" ],
      "additionalProperties": false
    },

    "id": {
      "type": "object",
      "properties": {
        "authority": { "type": "string" },
        "code": {
          "oneOf": [ { "type": "string" }, { "type": "integer" } ]
        }
      },
      "required" : [ "authority", "code" ],
      "additionalProperties": false
    },

    "method": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["OperationMethod"]},
        "name": { "type": "string" },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name" ],
      "additionalProperties": false
    },

    "object_usage": {
      "anyOf": [
      {
        "type": "object",
        "properties": {
            "scope": { "type": "string" },
            "area": { "type": "string" },
            "bbox": { "$ref": "#/definitions/bbox" },
            "remarks": { "type": "string" },
            "id": { "$ref": "#/definitions/id" }
        }
      },
      {
        "type": "object",
        "properties": {
            "usages": { "$ref": "#/definitions/usages" },
            "remarks": { "type": "string" },
            "id": { "$ref": "#/definitions/id" }
        }
      }
      ]
    },

    "parameter_value": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["ParameterValue"] },
        "name": { "type": "string" },
        "value": {
          "oneOf": [
            { "type": "string" },
            { "type": "number" }
           ]
        },
        "unit": { "$ref": "#/definitions/unit" },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name", "value" ],
      "additionalProperties": false
    },

    "parametric_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["ParametricCRS"] },
        "name": { "type": "string" },
        "datum": { "$ref": "#/definitions/parametric_datum" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "datum" ],
      "additionalProperties": false
    },

    "parametric_datum": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["ParametricDatum"] },
        "name": { "type": "string" },
        "anchor": { "type": "string" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name" ],
      "additionalProperties": false
    },

    "prime_meridian": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["PrimeMeridian"] },
        "name": { "type": "string" },
        "longitude": { "$ref": "#/definitions/value_and_unit" },
        "id": { "$ref": "#/definitions/id" }
      },
      "required" : [ "name" ],
      "additionalProperties": false
    },

    "single_operation": {
      "oneOf": [
        { "$ref": "#/definitions/conversion" },
        { "$ref": "#/definitions/transformation" }
      ]
    },

    "temporal_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["TemporalCRS"] },
        "name": { "type": "string" },
        "datum": { "$ref": "#/definitions/temporal_datum" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "datum" ],
      "additionalProperties": false
    },

    "temporal_datum": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["TemporalDatum"] },
        "name": { "type": "string" },
        "calendar": { "type": "string" },
        "time_origin": { "type": "string" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "calendar" ],
      "additionalProperties": false
    },

    "transformation": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["Transformation"] },
        "name": { "type": "string" },
        "source_crs": { "$ref": "#/definitions/crs" },
        "target_crs": { "$ref": "#/definitions/crs" },
        "interpolation_crs": { "$ref": "#/definitions/crs" },
        "method": { "$ref": "#/definitions/method" },
        "parameters": {
            "type": "array",
            "items": { "$ref": "#/definitions/parameter_value" }
        },
        "accuracy": { "type": "string" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "source_crs", "target_crs", "method", "parameters" ],
      "additionalProperties": false
    },

    "unit": {
      "oneOf": [
      {
        "type": "string",
        "enum": ["metre", "degree", "unity"]
      },
      {
        "type": "object",
        "properties": {
          "type": { "type": "string",
                    "enum": ["LinearUnit", "AngularUnit", "ScaleUnit",
                             "TimeUnit", "ParametricUnit", "Unit"] },
          "name": { "type": "string" },
          "conversion_factor": { "type": "number" },
          "id": { "$ref": "#/definitions/id" }
         },
         "required" : [ "type", "name" ],
         "additionalProperties": false
      }
      ]
    },

    "usages": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "scope": { "type": "string" },
            "area": { "type": "string" },
            "bbox": { "$ref": "#/definitions/bbox" }
           },
          "additionalProperties": false
        }
    },

    "value_and_unit": {
      "type": "object",
      "properties": {
        "value": { "type": "number" },
        "unit": { "$ref": "#/definitions/unit" }
      },
      "required" : [ "value", "unit" ],
      "additionalProperties": false
    },

    "value_in_metre_or_value_and_unit": {
      "oneOf": [
        { "type": "number" },
        { "$ref": "#/definitions/value_and_unit" }
      ]
    },

    "vertical_crs": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["VerticalCRS"] },
        "name": { "type": "string" },
        "datum": { "$ref": "#/definitions/vertical_reference_frame" },
        "coordinate_system": { "$ref": "#/definitions/coordinate_system" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name", "datum" ],
      "additionalProperties": false
    },

    "vertical_reference_frame": {
      "type": "object",
      "allOf": [{ "$ref": "#/definitions/object_usage" }],
      "properties": {
        "type": { "type": "string", "enum": ["VerticalReferenceFrame"] },
        "name": { "type": "string" },
        "anchor": { "type": "string" },
        "scope": {},
        "area": {},
        "bbox": {},
        "usages": {},
        "remarks": {},
        "id": {}
      },
      "required" : [ "name" ],
      "additionalProperties": false
    }

  }
}
